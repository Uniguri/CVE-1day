# CVE-2022-1015

OOB in nf_tables in `nft_parse_register_load` due to insufficient verification on `nft_validate_register_load`.

This exploit code uses "libnftnl" and "libmnl"

# Reference

- https://lore.kernel.org/netdev/20220317202534.41530-3-pablo@netfilter.org/
- https://elixir.bootlin.com/linux/v5.15.25/source/net/netfilter/nf_tables_api.c#L9241
- https://elixir.bootlin.com/linux/v5.15.25/source/net/netfilter/nf_tables_api.c#L9259
- https://elixir.bootlin.com/linux/v5.15.25/source/net/netfilter/nf_tables_api.c#L9259
- https://blog.dbouman.nl/2022/04/02/How-The-Tables-Have-Turned-CVE-2022-1015-1016/#441-leaving-the-softirq-context
- https://github.com/SnapRoute/netfilter/blob/master/libnftnl/src/expr/payload.c
- https://github.com/zasdfgbnm/nftables/blob/d423f0e99a3630a07f622a934f1041d55e8115c0/include/linux/netfilter/nf_tables.h#L55